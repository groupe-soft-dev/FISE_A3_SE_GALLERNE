<Window x:Class="EasySaveV2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Core.ViewModel;assembly=Core"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>

        </Grid.RowDefinitions>


        <!-- Partie HEAD avec les boutons, le changement de langue, etc -->
        <Grid Grid.Row="0" x:Name="HeaderGrid">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>


            <TextBlock Text="{Binding [easysave]}" FontSize="24" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="1"  Margin="10"/>

            <Button Name="select_all_button"
                    Content="{Binding [select_all]}"
                    Width="70" 
                    Height="20" 
                    Grid.Row="1" 
                    Grid.Column="0" 
                    Margin="15,0,0,5"
                    HorizontalAlignment="Left"
            />
            <Button Name="deselect_all_button"
                    Content="{Binding [reset]}" 
                    Width="70" 
                    Height="20" 
                    Grid.Row="1" 
                    Grid.Column="0" 
                    Margin="0,0,10,5" 
            />




            <Button Name="settings_button"
                    Content="{Binding [settings]}" 
                    Command="{Binding SettingsCommand}"
                    Width="100" 
                    Height="30" 
                    Grid.Row="0" 
                    Grid.Column="4" 
                    Margin="10"
            />
            <Button Name="log_button"
                    Content="Show logs" 
                    Width="100" 
                    Height="30" 
                    Grid.Row="0" 
                    Grid.Column="3" 
                    Margin="10"
            />
            <ComboBox Name="language_selector"
                      Grid.Row="1" 
                      Grid.Column="4"
                      Margin="10,0,10,10"
                      ItemsSource="{Binding AvailableLanguages}"
                      SelectedItem="{Binding CurrentLanguage, Mode=TwoWay}" Height="19"
            />

        </Grid>


        <!-- Partie MAIN - Datagrid -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding JobsList}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="True"
                  SelectionMode="Single"
                  Margin="10,0">

            <DataGrid.Columns>
                <DataGridTemplateColumn Header="Select">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding IsActive, Mode=TwoWay}"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Focusable="False"
                              ClickMode="Press" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn  Header="Id"
                        Binding="{Binding Id}"
                        Width="30"
                        IsReadOnly="True"
/>
                <DataGridTextColumn Header="Name"
                                    Binding="{Binding Name}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <DataGridCheckBoxColumn Header="Differential"
                                    Binding="{Binding Differential}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <DataGridCheckBoxColumn Header="Encryption"
                                        Binding="{Binding Encryption}"
                                        Width="*"
                                        IsReadOnly="True"
                />
                <DataGridTextColumn Header="Source"
                                    Binding="{Binding dirSource}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <DataGridTextColumn Header="Target"
                                    Binding="{Binding dirTarget}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <DataGridTextColumn Header="Creation date"
                                    Binding="{Binding CreationDate, StringFormat='{}{0:dd/MM/yyyy, HH\\hmm}'}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <DataGridTextColumn Header="Modification date"
                                    Binding="{Binding ModificationDate, StringFormat='{}{0:dd/MM/yyyy, HH\\hmm}'}"
                                    Width="*"
                                    IsReadOnly="True"
                />
                <!--
                <DataGridTextColumn Header="Last execution"
                                    Binding="{Binding LastExecution, StringFormat='{}{0:dd/MM/yyyy, HH\\hmm}'}"
                                    Width="*"
                />-->
                <DataGridTemplateColumn>
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="✏"
                                    Command="{Binding DataContext.ModifyJobCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                    CommandParameter="{Binding}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

            </DataGrid.Columns>

        </DataGrid>






        <!--
        <ScrollViewer Grid.Row="1" Margin="10,0,10,0" BorderThickness="2" BorderBrush="Black">
            <StackPanel>

                <CheckBox Margin="10" HorizontalContentAlignment="Stretch">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="Example job 1 |" 
                                   FontSize="14" 
                                   Grid.Row="0" 
                                   Grid.Column="0" 
                                   Margin="10,0,10,5"
                        />
                        <TextBlock Text="source/path/as/example" 
                                   FontSize="10" 
                                   Grid.Row="1" 
                                   Grid.Column="0" 
                                   Margin="10,0"
                        />
                        <TextBlock Text="➥ target/path/as/example" 
                                   FontSize="10" 
                                   Grid.Row="2" 
                                   Grid.Column="0" 
                                   Margin="10,0"
                        />

                        <TextBlock Text="Last execution : 03/05/2025, 15h48" 
                                   FontSize="10"
                                   FontStyle="Italic"
                                   Grid.Row="0" 
                                   Grid.Column="2" 
                                   Margin="10,5"
                        />

                        <Button Name="edit_button"
                                Content="🖋"
                                Width="30"
                                Height="40"
                                Grid.Row="0"
                                Grid.Column="3"
                                Grid.RowSpan="3"
                                Margin="10,0,0,0"
                                HorizontalAlignment="Left"
                        />
                        <Button Name="delete_button"
                                Content="🗑"
                                Width="30"
                                Height="40"
                                Grid.Row="0"
                                Grid.Column="3"
                                Grid.RowSpan="3"
                                Margin="45,0,10,0"
                                HorizontalAlignment="Right"
                        />


                    </Grid>
                </CheckBox>

            </StackPanel>
        </ScrollViewer>
        -->


        <!-- Partie FOOT -->
        <Grid Grid.Row="2">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>


            <Button Name="create_button"
                    Content="Create Job" 
                    Command="{Binding CreateJobCommand}"
                    Width="100" 
                    Height="30" 
                    Grid.Row="0" 
                    Grid.Column="0" 
                    Margin="10"
            />  
            

            <Button Name="start_button"
                    Content="START" 
                    Command="{Binding ExecuteSelectedJobsCommand}"
                    Width="100" 
                    Height="30" 
                    Grid.Row="0" 
                    Grid.Column="1" 
                    Margin="10"
            />

        </Grid>

    </Grid>
</Window>